import{i as te,_ as H,j as X,k as se,l as J,c as w,b as d,m as ie,w as o,F as E,n as q,p as U,r as l,v as ne,d as y,a as h,q as S,s as oe,x as G,e as Q,o as a,y as r,z as Y,A as Z,h as C,t as A,B as I,C as ae,u as le,D as L,T as ce,K as de,G as re}from"./index-ZDxLbVIp.js";const ee=te("tagsView",{state:()=>({visitedViews:[],cachedViews:[]}),actions:{addView(e){this.addVisitedView(e),this.addCachedView(e)},addVisitedView(e){this.visitedViews.some(t=>t.path===e.path)||this.visitedViews.push(Object.assign({},e,{title:e.meta.title||"no-name"}))},addCachedView(e){this.cachedViews.includes(e.name)||e.meta.noCache||this.cachedViews.push(e.name)},delView(e){return new Promise(t=>{this.delVisitedView(e),this.delCachedView(e),t({visitedViews:[...this.visitedViews],cachedViews:[...this.cachedViews]})})},delVisitedView(e){for(const[t,g]of this.visitedViews.entries())if(g.path===e.path){this.visitedViews.splice(t,1);break}},delCachedView(e){const t=this.cachedViews.indexOf(e.name);t>-1&&this.cachedViews.splice(t,1)},delOthersViews(e){return new Promise(t=>{this.delOthersVisitedViews(e),this.delOthersCachedViews(e),t({visitedViews:[...this.visitedViews],cachedViews:[...this.cachedViews]})})},delOthersVisitedViews(e){this.visitedViews=this.visitedViews.filter(t=>t.meta.affix||t.path===e.path)},delOthersCachedViews(e){const t=this.cachedViews.indexOf(e.name);t>-1?this.cachedViews=this.cachedViews.slice(t,t+1):this.cachedViews=[]},delAllViews(){return new Promise(e=>{this.delAllVisitedViews(),this.delAllCachedViews(),e({visitedViews:[...this.visitedViews],cachedViews:[...this.cachedViews]})})},delAllVisitedViews(){const e=this.visitedViews.filter(t=>t.meta.affix);this.visitedViews=e},delAllCachedViews(){this.cachedViews=[]},updateVisitedView(e){for(let t of this.visitedViews)if(t.path===e.path){t=Object.assign(t,e);break}}}}),ue={class:"tags-view-container"},he={__name:"index",setup(e){const t=y(!1),g=y(0),f=y(0),p=y({}),V=y([]),R=y(null),b=J(),v=Q(),_=ee(),k=U(()=>_.visitedViews);X(b,()=>{B(),N()}),X(t,s=>{s?document.body.addEventListener("click",T):document.body.removeEventListener("click",T)}),se(()=>{O(),B()});function m(s){return s.path===b.path}function x(s){return s.meta&&s.meta.affix}function O(){const s=[];for(const n of s)n.name&&_.addVisitedView(n)}function B(){const{name:s}=b;return s&&s!=="Login"&&_.addView(b),!1}function N(){G(()=>{})}function W(s){_.delCachedView(s).then(()=>{const{fullPath:n}=s;G(()=>{v.replace({path:"/redirect"+n}).catch(i=>{v.go(0)})})})}function $(s){_.delView(s).then(({visitedViews:n})=>{m(s)&&D(n,s)})}function M(){v.push(p.value),_.delOthersViews(p.value).then(()=>{N()})}function F(s){_.delAllViews().then(({visitedViews:n})=>{V.value.some(i=>i.path===s.path)||D(n,s)})}function D(s,n){const i=s.slice(-1)[0];i?v.push(i.fullPath):n.name==="Dashboard"?v.replace({path:"/redirect"+n.fullPath}):v.push("/")}function z(s,n){const u=n.target.getBoundingClientRect().left,c=n.target.closest(".tags-view-container").offsetWidth-105,P=n.clientX-u+15;P>c?f.value=c:f.value=P,f.value=n.clientX,g.value=n.clientY,t.value=!0,p.value=s}function T(){t.value=!1}function j(){T()}return(s,n)=>{const i=l("el-icon"),u=l("router-link"),K=l("el-scrollbar");return a(),w("div",ue,[d(K,{ref_key:"scrollPaneRef",ref:R,class:"tags-view-wrapper",onScroll:j},{default:o(()=>[(a(!0),w(E,null,q(k.value,c=>(a(),r(u,{key:c.path,"data-path":c.path,class:Z([m(c)?"active":"","tags-view-item"]),to:{path:c.path,query:c.query,fullPath:c.fullPath},onContextmenu:Y(P=>z(c,P),["prevent"])},{default:o(()=>[C(A(c.title)+" ",1),x(c)?S("",!0):(a(),r(i,{key:0,class:"close-icon",onClick:Y(P=>$(c),["prevent","stop"])},{default:o(()=>[d(I(ae))]),_:1},8,["onClick"]))]),_:2},1032,["data-path","class","to","onContextmenu"]))),128))]),_:1},512),ie(h("ul",{style:oe({left:f.value+"px",top:g.value+"px"}),class:"contextmenu"},[h("li",{onClick:n[0]||(n[0]=c=>W(p.value))},"刷新"),x(p.value)?S("",!0):(a(),w("li",{key:0,onClick:n[1]||(n[1]=c=>$(p.value))},"关闭")),h("li",{onClick:M},"关闭其他"),h("li",{onClick:n[2]||(n[2]=c=>F(p.value))},"关闭所有")],4),[[ne,t.value]])])}}},fe=H(he,[["__scopeId","data-v-4b425e0d"]]),pe={class:"layout-container"},_e={class:"logo"},me={key:0},we={key:1,class:"logo-collapsed"},Ve={class:"layout-main"},ve={class:"layout-header"},ke={class:"header-left"},xe={class:"header-right"},ge={class:"user-info"},ye={class:"user-name"},Ce={class:"layout-content"},be={__name:"index",setup(e){const t=J(),g=Q(),f=le(),p=ee(),V=y(!1),R=U(()=>p.cachedViews),b=U(()=>t.path),v=()=>{V.value=!V.value},_=k=>{k==="profile"?g.push("/profile"):k==="logout"&&re.confirm("确定要退出登录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.logout(),g.push("/login")})};return(k,m)=>{const x=l("el-icon"),O=l("el-menu-item"),B=l("el-sub-menu"),N=l("el-menu"),W=l("Expand"),$=l("Fold"),M=l("el-breadcrumb-item"),F=l("el-breadcrumb"),D=l("el-avatar"),z=l("ArrowDown"),T=l("el-dropdown-item"),j=l("el-dropdown-menu"),s=l("el-dropdown"),n=l("router-view");return a(),w("div",pe,[h("div",{class:Z(["layout-sidebar",{collapsed:V.value}])},[h("div",_e,[V.value?(a(),w("span",we,"UC")):(a(),w("span",me,"用户中心"))]),d(N,{"default-active":b.value,class:"dark-menu",collapse:V.value,router:"","background-color":"transparent","text-color":"#bfcbd9","active-text-color":"#409eff"},{default:o(()=>[(a(!0),w(E,null,q(I(f).menuRoutes,i=>(a(),w(E,{key:i.menuId||i.path},[i.children&&i.children.length>0?(a(),r(B,{key:0,index:i.path},{title:o(()=>[i.icon?(a(),r(x,{key:0},{default:o(()=>[(a(),r(L(i.icon)))]),_:2},1024)):S("",!0),h("span",null,A(i.menuName),1)]),default:o(()=>[(a(!0),w(E,null,q(i.children,u=>(a(),r(O,{key:u.menuId||u.path,index:u.path.startsWith("/")?u.path:i.path+"/"+u.path},{title:o(()=>[C(A(u.menuName),1)]),default:o(()=>[u.icon?(a(),r(x,{key:0},{default:o(()=>[(a(),r(L(u.icon)))]),_:2},1024)):S("",!0)]),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(a(),r(O,{key:1,index:i.path},{title:o(()=>[C(A(i.menuName),1)]),default:o(()=>[i.icon?(a(),r(x,{key:0},{default:o(()=>[(a(),r(L(i.icon)))]),_:2},1024)):S("",!0)]),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active","collapse"])],2),h("div",Ve,[h("div",ve,[h("div",ke,[d(x,{class:"collapse-btn",onClick:v},{default:o(()=>[V.value?(a(),r(W,{key:0})):(a(),r($,{key:1}))]),_:1}),d(F,{separator:"/"},{default:o(()=>[d(M,{to:{path:"/"}},{default:o(()=>[...m[0]||(m[0]=[C("首页",-1)])]),_:1}),k.$route.meta.title!=="首页"?(a(),r(M,{key:0},{default:o(()=>[C(A(k.$route.meta.title),1)]),_:1})):S("",!0)]),_:1})]),h("div",xe,[d(s,{onCommand:_},{dropdown:o(()=>[d(j,null,{default:o(()=>[d(T,{command:"profile"},{default:o(()=>[...m[1]||(m[1]=[C("个人中心",-1)])]),_:1}),d(T,{command:"logout",divided:""},{default:o(()=>[...m[2]||(m[2]=[C("退出登录",-1)])]),_:1})]),_:1})]),default:o(()=>{var i,u;return[h("span",ge,[d(D,{size:32,icon:"UserFilled"}),h("span",ye,A(((i=I(f).userInfo)==null?void 0:i.nickName)||((u=I(f).userInfo)==null?void 0:u.userName)),1),d(x,null,{default:o(()=>[d(z)]),_:1})])]}),_:1})])]),d(fe),h("div",Ce,[d(n,null,{default:o(({Component:i})=>[d(ce,{name:"fade",mode:"out-in"},{default:o(()=>[(a(),r(de,{include:R.value},[(a(),r(L(i),{key:k.$route.fullPath}))],1032,["include"]))]),_:2},1024)]),_:1})])])])}}},Ae=H(be,[["__scopeId","data-v-bafaeaa3"]]);export{Ae as default};
