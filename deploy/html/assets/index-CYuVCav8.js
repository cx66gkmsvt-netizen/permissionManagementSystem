import{l as X,g as Y,d as Z,u as ee,c as te}from"./dept-BHWUl4rM.js";import{x as le,d as p,c as ae,a as L,y as c,p as oe,b as e,m as v,w as l,r as n,z as S,f as de,o as _,h as u,t as A,s as ne,E as C}from"./index-BDk5bd72.js";const se={class:"page-card"},ue={class:"table-actions"},me={__name:"index",setup(pe){const V=p(!1),D=p([]),E=p([]),f=p(!1),w=p(""),k=p(!1),I=p(!0),N=p(!0),U=p(),a=de({deptId:null,parentId:0,deptName:"",sort:0,leader:"",phone:"",email:"",status:"0"}),M={deptName:[{required:!0,message:"请输入部门名称",trigger:"blur"}]};le(()=>{x()});const x=async()=>{V.value=!0;try{const s=await X();D.value=s.data||[],E.value=[{deptId:0,deptName:"根部门",children:s.data}]}finally{V.value=!1}},z=()=>{N.value=!1,I.value=!I.value,setTimeout(()=>{N.value=!0},0)},h=()=>{a.deptId=null,a.parentId=0,a.deptName="",a.sort=0,a.leader="",a.phone="",a.email="",a.status="0"},T=s=>{h(),s&&(a.parentId=s.deptId),w.value="新增部门",f.value=!0},O=async s=>{h();const d=(await Y(s.deptId)).data;Object.assign(a,{deptId:d.deptId,parentId:d.parentId,deptName:d.deptName,sort:d.sort,leader:d.leader,phone:d.phone,email:d.email,status:d.status}),w.value="编辑部门",f.value=!0},P=async()=>{await U.value.validate(),k.value=!0;try{a.deptId?(await ee(a.deptId,a),C.success("更新成功")):(await te(a),C.success("创建成功")),f.value=!1,x()}finally{k.value=!1}},R=s=>{ne.confirm("确定删除该部门吗？","提示",{type:"warning"}).then(async()=>{await Z(s.deptId),C.success("删除成功"),x()})},j=s=>s?new Date(s).toLocaleString("zh-CN"):"-";return(s,t)=>{const d=n("el-button"),r=n("el-table-column"),q=n("el-tag"),F=n("el-table"),G=n("el-tree-select"),i=n("el-form-item"),m=n("el-col"),g=n("el-row"),b=n("el-input"),H=n("el-input-number"),B=n("el-radio"),J=n("el-radio-group"),K=n("el-form"),Q=n("el-dialog"),y=S("permission"),W=S("loading");return _(),ae("div",se,[L("div",ue,[L("div",null,[c((_(),v(d,{type:"primary",icon:"Plus",onClick:t[0]||(t[0]=o=>T())},{default:l(()=>[...t[10]||(t[10]=[u("新增",-1)])]),_:1})),[[y,"system:dept:add"]]),e(d,{type:"info",icon:"Sort",onClick:z},{default:l(()=>[...t[11]||(t[11]=[u("展开/折叠",-1)])]),_:1})])]),N.value?c((_(),v(F,{key:0,data:D.value,"row-key":"deptId","default-expand-all":I.value,"tree-props":{children:"children"},border:""},{default:l(()=>[e(r,{prop:"deptName",label:"部门名称",width:"250"}),e(r,{prop:"sort",label:"排序",width:"100",align:"center"}),e(r,{prop:"leader",label:"负责人",width:"150"}),e(r,{prop:"phone",label:"联系电话",width:"150"}),e(r,{prop:"email",label:"邮箱",width:"200"}),e(r,{prop:"status",label:"状态",width:"100",align:"center"},{default:l(({row:o})=>[e(q,{type:o.status==="0"?"success":"danger"},{default:l(()=>[u(A(o.status==="0"?"正常":"停用"),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"createTime",label:"创建时间",width:"180"},{default:l(({row:o})=>[u(A(j(o.createTime)),1)]),_:1}),e(r,{label:"操作",width:"200",fixed:"right"},{default:l(({row:o})=>[c((_(),v(d,{type:"primary",link:"",icon:"Edit",onClick:$=>O(o)},{default:l(()=>[...t[12]||(t[12]=[u(" 编辑 ",-1)])]),_:1},8,["onClick"])),[[y,"system:dept:edit"]]),c((_(),v(d,{type:"success",link:"",icon:"Plus",onClick:$=>T(o)},{default:l(()=>[...t[13]||(t[13]=[u(" 新增 ",-1)])]),_:1},8,["onClick"])),[[y,"system:dept:add"]]),c((_(),v(d,{type:"danger",link:"",icon:"Delete",onClick:$=>R(o)},{default:l(()=>[...t[14]||(t[14]=[u(" 删除 ",-1)])]),_:1},8,["onClick"])),[[y,"system:dept:remove"]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[W,V.value]]):oe("",!0),e(Q,{modelValue:f.value,"onUpdate:modelValue":t[9]||(t[9]=o=>f.value=o),title:w.value,width:"600px","destroy-on-close":""},{footer:l(()=>[e(d,{onClick:t[8]||(t[8]=o=>f.value=!1)},{default:l(()=>[...t[17]||(t[17]=[u("取消",-1)])]),_:1}),e(d,{type:"primary",loading:k.value,onClick:P},{default:l(()=>[...t[18]||(t[18]=[u("确定",-1)])]),_:1},8,["loading"])]),default:l(()=>[e(K,{ref_key:"formRef",ref:U,model:a,rules:M,"label-width":"100px"},{default:l(()=>[e(g,{gutter:20},{default:l(()=>[e(m,{span:24},{default:l(()=>[e(i,{label:"上级部门",prop:"parentId"},{default:l(()=>[e(G,{modelValue:a.parentId,"onUpdate:modelValue":t[1]||(t[1]=o=>a.parentId=o),data:E.value,props:{label:"deptName",value:"deptId",children:"children"},placeholder:"请选择上级部门","check-strictly":"",style:{width:"100%"}},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:l(()=>[e(m,{span:12},{default:l(()=>[e(i,{label:"部门名称",prop:"deptName"},{default:l(()=>[e(b,{modelValue:a.deptName,"onUpdate:modelValue":t[2]||(t[2]=o=>a.deptName=o),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:l(()=>[e(i,{label:"排序",prop:"sort"},{default:l(()=>[e(H,{modelValue:a.sort,"onUpdate:modelValue":t[3]||(t[3]=o=>a.sort=o),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:l(()=>[e(m,{span:12},{default:l(()=>[e(i,{label:"负责人",prop:"leader"},{default:l(()=>[e(b,{modelValue:a.leader,"onUpdate:modelValue":t[4]||(t[4]=o=>a.leader=o),placeholder:"请输入负责人"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:l(()=>[e(i,{label:"联系电话",prop:"phone"},{default:l(()=>[e(b,{modelValue:a.phone,"onUpdate:modelValue":t[5]||(t[5]=o=>a.phone=o),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{gutter:20},{default:l(()=>[e(m,{span:12},{default:l(()=>[e(i,{label:"邮箱",prop:"email"},{default:l(()=>[e(b,{modelValue:a.email,"onUpdate:modelValue":t[6]||(t[6]=o=>a.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),e(m,{span:12},{default:l(()=>[e(i,{label:"状态",prop:"status"},{default:l(()=>[e(J,{modelValue:a.status,"onUpdate:modelValue":t[7]||(t[7]=o=>a.status=o)},{default:l(()=>[e(B,{value:"0"},{default:l(()=>[...t[15]||(t[15]=[u("正常",-1)])]),_:1}),e(B,{value:"1"},{default:l(()=>[...t[16]||(t[16]=[u("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}};export{me as default};
