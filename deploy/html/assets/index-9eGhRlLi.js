import{l as Y,g as Z,d as h,u as ee,c as le}from"./menu-BHtc4xvt.js";import{x as te,d as y,c as ne,a as L,y as V,p as _,b as t,m as d,w as l,r as m,z as S,f as ae,o as u,h as s,q as oe,t as ue,s as se,E as U}from"./index-BDk5bd72.js";const de={class:"page-card"},me={class:"table-actions"},fe={__name:"index",setup(ie){const T=y(!1),E=y([]),D=y([]),v=y(!1),I=y(""),C=y(!1),N=y(!0),x=y(!0),B=y(),n=ae({menuId:null,parentId:0,menuName:"",menuType:"M",path:"",component:"",perms:"",icon:"",sort:0,visible:"0",status:"0"}),O={menuName:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],menuType:[{required:!0,message:"请选择菜单类型",trigger:"change"}]};te(()=>{M()});const M=async()=>{T.value=!0;try{const i=await Y();E.value=i.data||[],D.value=[{menuId:0,menuName:"根目录",children:i.data}]}finally{T.value=!1}},P=()=>{x.value=!1,N.value=!N.value,setTimeout(()=>{x.value=!0},0)},F=()=>{n.menuId=null,n.parentId=0,n.menuName="",n.menuType="M",n.path="",n.component="",n.perms="",n.icon="",n.sort=0,n.visible="0",n.status="0"},$=i=>{F(),i&&(n.parentId=i.menuId),I.value="新增菜单",v.value=!0},R=async i=>{F();const o=(await Z(i.menuId)).data;Object.assign(n,{menuId:o.menuId,parentId:o.parentId,menuName:o.menuName,menuType:o.menuType,path:o.path,component:o.component,perms:o.perms,icon:o.icon,sort:o.sort,visible:o.visible,status:o.status}),I.value="编辑菜单",v.value=!0},j=async()=>{await B.value.validate(),C.value=!0;try{n.menuId?(await ee(n.menuId,n),U.success("更新成功")):(await le(n),U.success("创建成功")),v.value=!1,M()}finally{C.value=!1}},z=i=>{se.confirm("确定删除该菜单吗？","提示",{type:"warning"}).then(async()=>{await h(i.menuId),U.success("删除成功"),M()})};return(i,e)=>{const o=m("el-button"),p=m("el-table-column"),G=m("el-icon"),k=m("el-tag"),H=m("el-table"),J=m("el-tree-select"),r=m("el-form-item"),f=m("el-col"),c=m("el-row"),b=m("el-radio"),q=m("el-radio-group"),g=m("el-input"),K=m("el-input-number"),Q=m("el-form"),W=m("el-dialog"),w=S("permission"),X=S("loading");return u(),ne("div",de,[L("div",me,[L("div",null,[V((u(),d(o,{type:"primary",icon:"Plus",onClick:e[0]||(e[0]=a=>$())},{default:l(()=>[...e[12]||(e[12]=[s("新增",-1)])]),_:1})),[[w,"system:menu:add"]]),t(o,{type:"info",icon:"Sort",onClick:P},{default:l(()=>[...e[13]||(e[13]=[s("展开/折叠",-1)])]),_:1})])]),x.value?V((u(),d(H,{key:0,data:E.value,"row-key":"menuId","default-expand-all":N.value,"tree-props":{children:"children"},border:""},{default:l(()=>[t(p,{prop:"menuName",label:"菜单名称",width:"200"}),t(p,{prop:"icon",label:"图标",width:"80",align:"center"},{default:l(({row:a})=>[a.icon?(u(),d(G,{key:0},{default:l(()=>[(u(),d(oe(a.icon)))]),_:2},1024)):_("",!0)]),_:1}),t(p,{prop:"menuType",label:"类型",width:"80",align:"center"},{default:l(({row:a})=>[a.menuType==="M"?(u(),d(k,{key:0,type:"primary"},{default:l(()=>[...e[14]||(e[14]=[s("目录",-1)])]),_:1})):a.menuType==="C"?(u(),d(k,{key:1,type:"success"},{default:l(()=>[...e[15]||(e[15]=[s("菜单",-1)])]),_:1})):(u(),d(k,{key:2,type:"warning"},{default:l(()=>[...e[16]||(e[16]=[s("按钮",-1)])]),_:1}))]),_:1}),t(p,{prop:"sort",label:"排序",width:"80",align:"center"}),t(p,{prop:"perms",label:"权限标识",width:"200"}),t(p,{prop:"path",label:"路由地址",width:"150"}),t(p,{prop:"component",label:"组件路径",width:"200"}),t(p,{prop:"visible",label:"可见",width:"80",align:"center"},{default:l(({row:a})=>[t(k,{type:a.visible==="0"?"success":"info"},{default:l(()=>[s(ue(a.visible==="0"?"显示":"隐藏"),1)]),_:2},1032,["type"])]),_:1}),t(p,{label:"操作",width:"200",fixed:"right"},{default:l(({row:a})=>[V((u(),d(o,{type:"primary",link:"",icon:"Edit",onClick:A=>R(a)},{default:l(()=>[...e[17]||(e[17]=[s(" 编辑 ",-1)])]),_:1},8,["onClick"])),[[w,"system:menu:edit"]]),V((u(),d(o,{type:"success",link:"",icon:"Plus",onClick:A=>$(a)},{default:l(()=>[...e[18]||(e[18]=[s(" 新增 ",-1)])]),_:1},8,["onClick"])),[[w,"system:menu:add"]]),V((u(),d(o,{type:"danger",link:"",icon:"Delete",onClick:A=>z(a)},{default:l(()=>[...e[19]||(e[19]=[s(" 删除 ",-1)])]),_:1},8,["onClick"])),[[w,"system:menu:remove"]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[X,T.value]]):_("",!0),t(W,{modelValue:v.value,"onUpdate:modelValue":e[11]||(e[11]=a=>v.value=a),title:I.value,width:"700px","destroy-on-close":""},{footer:l(()=>[t(o,{onClick:e[10]||(e[10]=a=>v.value=!1)},{default:l(()=>[...e[25]||(e[25]=[s("取消",-1)])]),_:1}),t(o,{type:"primary",loading:C.value,onClick:j},{default:l(()=>[...e[26]||(e[26]=[s("确定",-1)])]),_:1},8,["loading"])]),default:l(()=>[t(Q,{ref_key:"formRef",ref:B,model:n,rules:O,"label-width":"100px"},{default:l(()=>[t(c,{gutter:20},{default:l(()=>[t(f,{span:24},{default:l(()=>[t(r,{label:"上级菜单"},{default:l(()=>[t(J,{modelValue:n.parentId,"onUpdate:modelValue":e[1]||(e[1]=a=>n.parentId=a),data:D.value,props:{label:"menuName",value:"menuId",children:"children"},placeholder:"请选择上级菜单","check-strictly":"",style:{width:"100%"}},null,8,["modelValue","data"])]),_:1})]),_:1})]),_:1}),t(c,{gutter:20},{default:l(()=>[t(f,{span:12},{default:l(()=>[t(r,{label:"菜单类型",prop:"menuType"},{default:l(()=>[t(q,{modelValue:n.menuType,"onUpdate:modelValue":e[2]||(e[2]=a=>n.menuType=a)},{default:l(()=>[t(b,{value:"M"},{default:l(()=>[...e[20]||(e[20]=[s("目录",-1)])]),_:1}),t(b,{value:"C"},{default:l(()=>[...e[21]||(e[21]=[s("菜单",-1)])]),_:1}),t(b,{value:"F"},{default:l(()=>[...e[22]||(e[22]=[s("按钮",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n.menuType!=="F"?(u(),d(f,{key:0,span:12},{default:l(()=>[t(r,{label:"菜单图标"},{default:l(()=>[t(g,{modelValue:n.icon,"onUpdate:modelValue":e[3]||(e[3]=a=>n.icon=a),placeholder:"请输入图标名称"},null,8,["modelValue"])]),_:1})]),_:1})):_("",!0)]),_:1}),t(c,{gutter:20},{default:l(()=>[t(f,{span:12},{default:l(()=>[t(r,{label:"菜单名称",prop:"menuName"},{default:l(()=>[t(g,{modelValue:n.menuName,"onUpdate:modelValue":e[4]||(e[4]=a=>n.menuName=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1})]),_:1}),t(f,{span:12},{default:l(()=>[t(r,{label:"排序",prop:"sort"},{default:l(()=>[t(K,{modelValue:n.sort,"onUpdate:modelValue":e[5]||(e[5]=a=>n.sort=a),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n.menuType!=="F"?(u(),d(c,{key:0,gutter:20},{default:l(()=>[t(f,{span:12},{default:l(()=>[t(r,{label:"路由地址",prop:"path"},{default:l(()=>[t(g,{modelValue:n.path,"onUpdate:modelValue":e[6]||(e[6]=a=>n.path=a),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1})]),_:1}),n.menuType==="C"?(u(),d(f,{key:0,span:12},{default:l(()=>[t(r,{label:"组件路径",prop:"component"},{default:l(()=>[t(g,{modelValue:n.component,"onUpdate:modelValue":e[7]||(e[7]=a=>n.component=a),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1})]),_:1})):_("",!0)]),_:1})):_("",!0),t(c,{gutter:20},{default:l(()=>[n.menuType!=="M"?(u(),d(f,{key:0,span:12},{default:l(()=>[t(r,{label:"权限标识",prop:"perms"},{default:l(()=>[t(g,{modelValue:n.perms,"onUpdate:modelValue":e[8]||(e[8]=a=>n.perms=a),placeholder:"如: system:user:list"},null,8,["modelValue"])]),_:1})]),_:1})):_("",!0),n.menuType!=="F"?(u(),d(f,{key:1,span:12},{default:l(()=>[t(r,{label:"显示状态",prop:"visible"},{default:l(()=>[t(q,{modelValue:n.visible,"onUpdate:modelValue":e[9]||(e[9]=a=>n.visible=a)},{default:l(()=>[t(b,{value:"0"},{default:l(()=>[...e[23]||(e[23]=[s("显示",-1)])]),_:1}),t(b,{value:"1"},{default:l(()=>[...e[24]||(e[24]=[s("隐藏",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})):_("",!0)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}};export{fe as default};
